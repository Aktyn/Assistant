import { wait, randomInt } from '@aktyn-assistant/common'

const LOREM_IPSUM = `Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Lectus mauris ultrices eros in cursus. Ornare lectus sit amet est placerat in. Dis parturient montes nascetur ridiculus mus mauris vitae. Ultrices mi tempus imperdiet nulla. Erat imperdiet sed euismod nisi. Aliquet lectus proin nibh nisl condimentum id venenatis a condimentum. Ut sem nulla pharetra diam sit amet nisl suscipit adipiscing. At augue eget arcu dictum varius. Netus et malesuada fames ac turpis egestas integer eget aliquet. Semper viverra nam libero justo. Lobortis feugiat vivamus at augue eget. Netus et malesuada fames ac turpis. Et magnis dis parturient montes. Diam phasellus vestibulum lorem sed risus ultricies tristique nulla aliquet. Rutrum tellus pellentesque eu tincidunt. Aliquet eget sit amet tellus cras. Aenean pharetra magna ac placerat vestibulum lectus mauris ultrices eros. Ullamcorper malesuada proin libero nunc consequat.

Aenean pharetra magna ac placerat vestibulum. Dignissim cras tincidunt lobortis feugiat vivamus at. Purus in mollis nunc sed id semper. Ultricies leo integer malesuada nunc. Sed tempus urna et pharetra pharetra massa massa. Consequat mauris nunc congue nisi vitae suscipit tellus mauris. Maecenas sed enim ut sem. Semper feugiat nibh sed pulvinar proin gravida. Sed risus pretium quam vulputate dignissim. Imperdiet sed euismod nisi porta lorem mollis. Odio ut sem nulla pharetra diam. Faucibus interdum posuere lorem ipsum dolor. Pulvinar etiam non quam lacus suspendisse faucibus interdum posuere lorem. Enim ut tellus elementum sagittis vitae et leo duis ut. In eu mi bibendum neque egestas congue quisque egestas diam. Viverra nibh cras pulvinar mattis nunc sed blandit libero.

Ac placerat vestibulum lectus mauris ultrices eros in cursus turpis. Viverra aliquet eget sit amet. Tincidunt vitae semper quis lectus nulla at volutpat. Quam id leo in vitae turpis massa sed. Lorem donec massa sapien faucibus et molestie. Amet luctus venenatis lectus magna fringilla urna porttitor rhoncus dolor. Eget felis eget nunc lobortis mattis aliquam faucibus purus. Vitae tortor condimentum lacinia quis vel. Pellentesque pulvinar pellentesque habitant morbi tristique senectus et netus. Sed risus ultricies tristique nulla aliquet enim tortor.

Gravida rutrum quisque non tellus orci. Arcu vitae elementum curabitur vitae nunc sed. Diam vel quam elementum pulvinar. Et odio pellentesque diam volutpat commodo sed. Tincidunt eget nullam non nisi. Nisi lacus sed viverra tellus in hac. Tortor dignissim convallis aenean et tortor. Eu nisl nunc mi ipsum faucibus vitae aliquet. Ut sem nulla pharetra diam sit. Sollicitudin aliquam ultrices sagittis orci a scelerisque purus semper. Nunc aliquet bibendum enim facilisis gravida neque convallis. Nam at lectus urna duis convallis convallis tellus id interdum.

Mattis enim ut tellus elementum sagittis. Fermentum leo vel orci porta non pulvinar. In nisl nisi scelerisque eu ultrices vitae auctor eu. Sed enim ut sem viverra. Massa ultricies mi quis hendrerit dolor magna eget. Nulla posuere sollicitudin aliquam ultrices sagittis orci a scelerisque purus. Est ullamcorper eget nulla facilisi etiam dignissim diam. Urna condimentum mattis pellentesque id nibh tortor. Vestibulum lectus mauris ultrices eros in cursus turpis. Gravida in fermentum et sollicitudin ac. In fermentum et sollicitudin ac orci phasellus egestas. Semper feugiat nibh sed pulvinar.

Viverra justo nec ultrices dui sapien eget mi. Diam ut venenatis tellus in metus. Nec ultrices dui sapien eget mi proin sed libero enim. Accumsan in nisl nisi scelerisque eu. Ultrices eros in cursus turpis massa tincidunt dui ut. Amet mattis vulputate enim nulla aliquet porttitor lacus luctus accumsan. Ultricies mi eget mauris pharetra et ultrices neque ornare. Erat pellentesque adipiscing commodo elit. Ut lectus arcu bibendum at varius vel pharetra vel. Egestas diam in arcu cursus euismod quis. Suspendisse potenti nullam ac tortor. Felis eget velit aliquet sagittis. Ut faucibus pulvinar elementum integer enim neque volutpat. Enim tortor at auctor urna nunc id cursus metus. Dis parturient montes nascetur ridiculus mus mauris vitae ultricies. Rutrum quisque non tellus orci ac auctor. Eget nulla facilisi etiam dignissim diam quis enim lobortis. In egestas erat imperdiet sed. Pharetra massa massa ultricies mi quis hendrerit. Cras adipiscing enim eu turpis egestas pretium.

Blandit volutpat maecenas volutpat blandit aliquam etiam. Scelerisque mauris pellentesque pulvinar pellentesque habitant morbi tristique senectus et. Volutpat consequat mauris nunc congue nisi vitae. Tincidunt augue interdum velit euismod. Et tortor at risus viverra adipiscing at in. Sodales ut etiam sit amet nisl purus in mollis nunc. Tempus urna et pharetra pharetra massa massa ultricies. Sed vulputate odio ut enim blandit volutpat. Pretium quam vulputate dignissim suspendisse in est. Cursus vitae congue mauris rhoncus aenean vel elit scelerisque mauris. Amet dictum sit amet justo donec enim. In pellentesque massa placerat duis ultricies lacus sed. Tristique sollicitudin nibh sit amet. Velit egestas dui id ornare arcu odio ut sem.

Viverra justo nec ultrices dui sapien. Fringilla ut morbi tincidunt augue interdum velit euismod in pellentesque. Fermentum odio eu feugiat pretium nibh ipsum consequat nisl. Orci phasellus egestas tellus rutrum tellus pellentesque. Enim ut sem viverra aliquet eget sit amet tellus. Morbi tempus iaculis urna id volutpat lacus laoreet non. Duis ultricies lacus sed turpis tincidunt id aliquet risus feugiat. Elit sed vulputate mi sit amet mauris commodo quis imperdiet. Etiam tempor orci eu lobortis elementum nibh tellus. Arcu risus quis varius quam quisque id. Pharetra et ultrices neque ornare aenean. Et netus et malesuada fames ac.

Varius morbi enim nunc faucibus a pellentesque. Dui vivamus arcu felis bibendum ut. Porttitor massa id neque aliquam. Posuere urna nec tincidunt praesent semper feugiat nibh. Massa enim nec dui nunc. Malesuada nunc vel risus commodo viverra maecenas. Volutpat odio facilisis mauris sit. Ac turpis egestas maecenas pharetra convallis posuere morbi leo. Laoreet non curabitur gravida arcu ac tortor. Blandit massa enim nec dui nunc.

Aenean vel elit scelerisque mauris. Purus sit amet volutpat consequat mauris nunc. Hac habitasse platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper. Non diam phasellus vestibulum lorem sed risus. At imperdiet dui accumsan sit amet nulla. Sed euismod nisi porta lorem. Risus nullam eget felis eget nunc lobortis mattis. Non curabitur gravida arcu ac tortor dignissim convallis aenean et. Massa massa ultricies mi quis hendrerit dolor magna eget est. Tristique senectus et netus et malesuada fames. Elementum sagittis vitae et leo. Tortor aliquam nulla facilisi cras fermentum odio eu feugiat. Turpis egestas maecenas pharetra convallis posuere.

Sit amet aliquam id diam maecenas ultricies. Diam sit amet nisl suscipit adipiscing bibendum est ultricies integer. Ultrices sagittis orci a scelerisque purus semper. Hac habitasse platea dictumst vestibulum rhoncus est pellentesque elit. Imperdiet nulla malesuada pellentesque elit eget gravida cum. Condimentum mattis pellentesque id nibh tortor id aliquet. Ornare suspendisse sed nisi lacus sed viverra tellus in hac. At urna condimentum mattis pellentesque. Leo vel orci porta non pulvinar neque laoreet suspendisse interdum. Ultricies integer quis auctor elit sed vulputate mi sit amet. Congue eu consequat ac felis. Ultrices vitae auctor eu augue ut lectus arcu. Nulla posuere sollicitudin aliquam ultrices sagittis orci a. A cras semper auctor neque vitae tempus quam pellentesque. Sed lectus vestibulum mattis ullamcorper velit sed ullamcorper morbi. Nibh praesent tristique magna sit.

Nulla facilisi nullam vehicula ipsum a. Sit amet consectetur adipiscing elit ut aliquam purus sit. Volutpat ac tincidunt vitae semper quis. Dictum varius duis at consectetur. Eget est lorem ipsum dolor sit amet consectetur adipiscing. Lacus sed viverra tellus in hac habitasse. In nibh mauris cursus mattis molestie a iaculis at erat. Commodo quis imperdiet massa tincidunt nunc pulvinar sapien. Ipsum dolor sit amet consectetur adipiscing elit ut. Arcu odio ut sem nulla. In mollis nunc sed id semper. Eget mi proin sed libero enim. Amet tellus cras adipiscing enim eu. Sed vulputate mi sit amet mauris commodo quis imperdiet massa. Eros in cursus turpis massa tincidunt dui. Lacus sed viverra tellus in hac habitasse platea dictumst. Vulputate sapien nec sagittis aliquam malesuada bibendum arcu. Cursus mattis molestie a iaculis at erat. Ligula ullamcorper malesuada proin libero nunc consequat interdum varius sit. Pellentesque habitant morbi tristique senectus et netus et malesuada fames.

Mattis nunc sed blandit libero volutpat sed cras ornare arcu. Sit amet mattis vulputate enim nulla. Faucibus purus in massa tempor nec feugiat nisl pretium fusce. Dictum non consectetur a erat nam at lectus. Nibh mauris cursus mattis molestie a iaculis at. Adipiscing elit pellentesque habitant morbi tristique. Pellentesque dignissim enim sit amet venenatis urna cursus. Morbi tristique senectus et netus et malesuada fames. Consectetur adipiscing elit duis tristique sollicitudin nibh sit amet. Nisi porta lorem mollis aliquam ut porttitor leo a. Massa massa ultricies mi quis hendrerit dolor magna eget. In fermentum posuere urna nec tincidunt praesent. Id donec ultrices tincidunt arcu. Eget est lorem ipsum dolor sit amet consectetur adipiscing elit. Mi eget mauris pharetra et ultrices neque ornare. Nullam ac tortor vitae purus. Ullamcorper velit sed ullamcorper morbi tincidunt ornare massa eget egestas.

Amet mauris commodo quis imperdiet massa. Aliquet porttitor lacus luctus accumsan tortor posuere ac. In vitae turpis massa sed elementum tempus egestas. Diam sollicitudin tempor id eu. Viverra aliquet eget sit amet tellus cras adipiscing. Sagittis eu volutpat odio facilisis mauris sit. Pretium lectus quam id leo in vitae turpis massa. Est sit amet facilisis magna etiam tempor. Suspendisse sed nisi lacus sed viverra tellus in hac habitasse. Vestibulum sed arcu non odio euismod lacinia at.

Odio eu feugiat pretium nibh ipsum consequat nisl vel pretium. Lacus suspendisse faucibus interdum posuere lorem ipsum dolor sit. Aenean pharetra magna ac placerat vestibulum. Malesuada fames ac turpis egestas maecenas. Nunc vel risus commodo viverra maecenas accumsan lacus vel. Faucibus nisl tincidunt eget nullam non nisi. Quam vulputate dignissim suspendisse in est ante in. Mattis vulputate enim nulla aliquet porttitor lacus. Malesuada fames ac turpis egestas maecenas pharetra convallis posuere morbi. Aenean sed adipiscing diam donec adipiscing tristique risus nec. Maecenas ultricies mi eget mauris pharetra. Et molestie ac feugiat sed lectus vestibulum mattis ullamcorper velit.

Sed lectus vestibulum mattis ullamcorper velit sed ullamcorper morbi. Eu lobortis elementum nibh tellus molestie nunc non. Ut tellus elementum sagittis vitae et leo duis ut diam. Egestas quis ipsum suspendisse ultrices gravida dictum fusce. Urna neque viverra justo nec ultrices dui sapien eget mi. Nunc non blandit massa enim. Sed cras ornare arcu dui vivamus arcu felis bibendum ut. Mauris in aliquam sem fringilla ut. Velit ut tortor pretium viverra. Amet volutpat consequat mauris nunc. Varius vel pharetra vel turpis nunc eget lorem dolor. Sed odio morbi quis commodo odio aenean sed adipiscing diam. Malesuada nunc vel risus commodo viverra maecenas accumsan lacus vel. Gravida cum sociis natoque penatibus et magnis dis parturient. Gravida cum sociis natoque penatibus et magnis dis. Hac habitasse platea dictumst quisque sagittis purus sit. Quam id leo in vitae turpis massa sed elementum. Accumsan sit amet nulla facilisi morbi tempus iaculis urna id. Amet porttitor eget dolor morbi non arcu risus quis varius. Orci porta non pulvinar neque laoreet suspendisse interdum consectetur libero.

Massa eget egestas purus viverra accumsan in. Sagittis orci a scelerisque purus semper eget duis. Vehicula ipsum a arcu cursus vitae. A cras semper auctor neque vitae tempus quam. Sit amet massa vitae tortor condimentum. Vel orci porta non pulvinar neque. Odio facilisis mauris sit amet. Tortor posuere ac ut consequat semper viverra. Tempor orci dapibus ultrices in. Pretium fusce id velit ut tortor pretium viverra. Malesuada bibendum arcu vitae elementum curabitur vitae.

Nec sagittis aliquam malesuada bibendum arcu vitae. Turpis egestas sed tempus urna et pharetra pharetra massa. Sit amet tellus cras adipiscing enim eu turpis egestas pretium. Turpis tincidunt id aliquet risus feugiat in ante metus dictum. At elementum eu facilisis sed odio morbi quis commodo odio. Fusce ut placerat orci nulla pellentesque dignissim enim sit. Quis enim lobortis scelerisque fermentum dui faucibus in ornare quam. Magna fermentum iaculis eu non diam phasellus vestibulum lorem sed. Nisl purus in mollis nunc sed id semper risus in. Sagittis purus sit amet volutpat consequat mauris nunc congue nisi. Sed ullamcorper morbi tincidunt ornare massa. Consequat nisl vel pretium lectus quam id leo. At consectetur lorem donec massa sapien. Nulla pellentesque dignissim enim sit amet. Sit amet luctus venenatis lectus magna. Orci nulla pellentesque dignissim enim sit amet venenatis urna cursus.

Pulvinar sapien et ligula ullamcorper malesuada proin libero nunc consequat. Diam quis enim lobortis scelerisque fermentum dui faucibus in. In cursus turpis massa tincidunt. Aliquam ut porttitor leo a diam. Auctor elit sed vulputate mi sit. Diam maecenas ultricies mi eget mauris. Odio ut enim blandit volutpat maecenas volutpat blandit aliquam. Quam nulla porttitor massa id neque aliquam vestibulum morbi blandit. Libero id faucibus nisl tincidunt eget. Morbi leo urna molestie at elementum. Et magnis dis parturient montes. Tincidunt lobortis feugiat vivamus at augue. Senectus et netus et malesuada fames ac. Tincidunt tortor aliquam nulla facilisi cras fermentum. Et netus et malesuada fames.

Enim facilisis gravida neque convallis a. Consequat mauris nunc congue nisi vitae. At ultrices mi tempus imperdiet. Amet consectetur adipiscing elit pellentesque habitant morbi tristique senectus et. In cursus turpis massa tincidunt dui ut. Dui accumsan sit amet nulla facilisi morbi tempus. Eu feugiat pretium nibh ipsum consequat nisl. Donec ultrices tincidunt arcu non sodales neque sodales ut. Rhoncus dolor purus non enim praesent elementum facilisis leo. Ultrices vitae auctor eu augue ut lectus arcu bibendum at.`

const RESPONSE_WITH_CODE = `To achieve this task, we can use the \`stat\` command in Linux to get the creation date of each file in the directory, and then use \`sort\` and \`awk\` to group the files by the day they were created. Here's the Linux bash command that accomplishes this:

\`\`\`bash
#!/bin/bash
stat --format="%y %n" * | sort -k1 | awk '{print $1, $2}' | awk '{print $1}' FS="-" | uniq -c
\`\`\`

In this command:
- \`stat --format="%y %n" *\` will display the creation date and filename of each file in the directory.
- \`sort -k1\` will sort the output based on the creation date.
- \`awk '{print $1, $2}'\` will select and print the date and time part of the output.
- \`awk '{print $1}' FS="-"\` will extract and print only the day part of the date.
- \`uniq -c\` will display the unique days along with the count of files created on each day.

You can run this command in the directory of interest to list every file grouped by the day on which it was created.`

export const LOREM_IPSUM_WORDS = LOREM_IPSUM.trim()
  .replace(/\.\s/g, '.\n')
  .split(' ')
  .map((word) => word.trim() + ' ')

export const RESPONSE_WITH_CODE_WORDS = RESPONSE_WITH_CODE.trim()
  .replace(/\.\s/g, '.\n')
  .split(' ')
  .map((word) => word.trim() + ' ')

export function mockChatStream<ResponseType extends object | string>(
  parser: (content: string, isLast: boolean) => ResponseType,
  length = randomInt(100, 150),
  delayBetweenMessages = () => randomInt(10, 50),
) {
  // const source = randomInt(0, 1) ? RESPONSE_WITH_CODE_WORDS : LOREM_IPSUM_WORDS //TODO: restore
  const source = randomInt(0, 10) ? RESPONSE_WITH_CODE_WORDS : LOREM_IPSUM_WORDS

  length = Math.min(length, source.length)

  const controller = new AbortController()
  return {
    async *[Symbol.asyncIterator]() {
      for (let i = 0; i < length; i++) {
        if (controller.signal.aborted) {
          return
        }

        await wait(delayBetweenMessages())
        yield parser(source[i], i === length - 1)
      }
    },
    controller,
  }
}
